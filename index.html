<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>
  <link rel="stylesheet" href="Style.css">
</head>
<body>
  <div class="login-container">
    <h1>Login</h1>
    <form id="auth-form">
      <label for="email">Email</label>
      <input type="email" id="email" placeholder="Enter your email" required>
      <label for="password">Password</label>
      <input type="password" id="password" placeholder="Enter your password" required>
      <label>
        <input type="checkbox" id="rememberMe"> Save credentials on this device
      </label>
      <button type="button" id="login-button">Login</button>
      <button type="button" id="signup-button">Sign Up</button>
    </form>
    <p id="error-message" style="color: red;"></p>
  </div>
  

 <script type="module" src="firebase.js"></script>
 
 <script type="module">
 
// Online login function (‡¶Ü‡¶™‡¶®‡¶ø ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶è‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®)
function onlineLogin(email, password) {
  // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶ø Firebase Authentication ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶≤‡¶ó‡¶ø‡¶® ‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®
  // ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£‡¶∏‡ßç‡¶¨‡¶∞‡ßÇ‡¶™:
  // signInWithEmailAndPassword(auth, email, password)...
  // ‡¶§‡¶¨‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶ß‡ßÅ online login-‡¶è ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú‡ßá ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶õ‡¶ø
  localStorage.setItem("user", JSON.stringify({ email, password }));
  window.location.href = "home.html";
}

// Offline login function using stored credentials
function offlineLogin(email, password) {
  const storedData = localStorage.getItem("user");
  if (storedData) {
    const storedUser = JSON.parse(storedData);
    if (storedUser.email === email && storedUser.password === password) {
      // ‡¶Ø‡¶¶‡¶ø credentials ‡¶Æ‡ßá‡¶≤‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá offline login ‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏‡¶´‡ßÅ‡¶≤ ‡¶π‡¶¨‡ßá
      window.location.href = "home.html";
    } else {
      document.getElementById("error-message").innerText = "Invalid credentials in offline mode!";
    }
  } else {
    document.getElementById("error-message").innerText = "No stored credentials found!";
  }
}

// Event listener for login button
document.getElementById("login-button").addEventListener("click", function () {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  
  if (email === "" || password === "") {
    document.getElementById("error-message").innerText = "Please enter both email and password!";
    return;
  }

  // Check if browser is online
  if (navigator.onLine) {
    // Online login: ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶ø Firebase Authentication ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®
    onlineLogin(email, password);
  } else {
    // Offline login: ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá
    offlineLogin(email, password);
  }
});

// üîπ DOM ‡¶è‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®
const emailInput = document.getElementById("email");
const passwordInput = document.getElementById("password");
const loginButton = document.getElementById("login-button");
const signupButton = document.getElementById("signup-button");
const rememberMeCheckbox = document.getElementById("rememberMe");
const errorMessage = document.getElementById("error-message");

// ‚úÖ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶≤‡¶ó‡¶ø‡¶® ‡¶§‡¶•‡ßç‡¶Ø (‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá) ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶•‡ßá‡¶ï‡ßá ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
if (localStorage.getItem("rememberMe") === "true") {
    emailInput.value = localStorage.getItem("email") || "";
    passwordInput.value = localStorage.getItem("password") || "";
    rememberMeCheckbox.checked = true;
}

// üî• **‡¶≤‡¶ó‡¶ø‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®**
loginButton.addEventListener("click", () => {
    const email = emailInput.value.trim();
    const password = passwordInput.value.trim();
    const rememberMe = rememberMeCheckbox.checked;

    if (!email || !password) {
        errorMessage.textContent = "‚ö†Ô∏è Please enter both email and password!";
        return;
    }

    signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
            console.log("‚úÖ Login Successful:", userCredential.user);
            
            // ‚úÖ "Remember Me" ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶π‡¶≤‡ßá ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
            if (rememberMe) {
                localStorage.setItem("rememberMe", "true");
                localStorage.setItem("email", email);
                localStorage.setItem("password", password);
            } else {
                localStorage.removeItem("rememberMe");
                localStorage.removeItem("email");
                localStorage.removeItem("password");
            }

            // üîπ ‡¶π‡ßã‡¶Æ ‡¶™‡ßá‡¶ú‡ßá ‡¶∞‡¶ø‡¶°‡¶æ‡¶á‡¶∞‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            window.location.href = "home.html";
        })
        .catch((error) => {
            console.error("‚ùå Login Error:", error.message);
            errorMessage.textContent = "‚ùå Invalid email or password!";
        });
});

// üî• **‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®**
signupButton.addEventListener("click", () => {
    const email = emailInput.value.trim();
    const password = passwordInput.value.trim();

    if (!email || !password) {
        errorMessage.textContent = "‚ö†Ô∏è Please enter email and password to sign up!";
        return;
    }

    createUserWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
            console.log("‚úÖ Account Created Successfully:", userCredential.user);
            alert("üéâ Account Created! Now you can log in.");
        })
        .catch((error) => {
            console.error("‚ùå Sign Up Error:", error.message);
            errorMessage.textContent = "‚ùå Could not create account. Try again!";
        });
});

 </script>
</body>
</html>
